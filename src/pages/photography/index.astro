---
import Layout from "@/layouts/BaseLayout";

import { getCollection } from "astro:content";
import { cosmic } from "@/library/cosmic";
import Container from "@/components/content/Container";
import Featured from "@/components/shoots/cards/Featured";
import Figure from "@/components/image/Image";
import Heading from "@/components/content/Heading";
import Section from "@/components/content/Section";
import Testimonial from "@/components/Testimonial";

const testimonials = await getCollection("testimonial");
console.log(testimonials[0].data.shoot.metadata);

const featured = await getCollection("shoot", ({ data }) => {
	return data.shoot.featured;
});

const { object: page } = await cosmic.objects
	.findOne({
		type: "page-photography",
		slug: "page-photography",
	})
	.props("metadata");
---

<Layout title={page.metadata.seo.title} description={page.metadata.seo.description}>
	<Container>
		<Heading>
			<h1 slot="heading">{page.metadata.content.heading}</h1>
			<div slot="description" set:html={page.metadata.content.description} />
		</Heading>
	</Container>

	<Section size="large">
		<div class="space-y-12 @container">
			<Container size="large">
				<div class="grid grid-cols-1 @sm:grid-cols-2 @sm:md:grid-cols-3 @sm:lg:grid-cols-4 gap-4 sm:gap-6 lg:gap-y-16">
					{featured.slice(0, 12).map((f) => <Featured shoot={f} />)}
				</div>
			</Container>

			<Container>
				<div class="flex justify-center items-center gap-4">
					<a href="/contact" class="button button-primary w-full sm:w-fit shadow-md">Hire Me!</a>
					<a href="/photography/shoots" class="button button-ghost w-full sm:w-fit shadow-md">More Shoots</a>
				</div>
			</Container>
		</div>

		<Container>
			<section class="space-y-14">
				<h2 class="text-center sm:text-left max-w-140 text-balance">What my prior clients are saying.</h2>

				<div class="grid md:grid-cols-9 gap-8 md:gap-10 mx-auto">
					<Figure src="https://cdn.cosmicjs.com/e586a8a0-760b-11ef-915f-61acd7484848-1970-porsche-911t-coupe_003.jpg" figureClass="md:col-span-5 w-full h-full" class="object-cover w-full h-full" />

					{
						testimonials.slice(0, 1).map((t) => (
							<div class="md:col-span-4 space-y-6 md:py-8">
								<div class="text-3xl tracking-tight">"{t.data.title}"</div>
								<div class="space-y-6 leading-7" set:html={t.data.testimonial} />
								<div class="space-y-2">
									<div class="font-medium">{t.data.name}.</div>
									<div class="text-sm">
										{t.data.shoot.title}
										<br />
										Sold on Hagerty for $77,000
									</div>
								</div>
							</div>
						))
					}
				</div>
			</section>
		</Container>

		<!-- <Container size="large">
			<div class="grid grid-cols-12 gap-4 md:gap-6">
				<Figure figureClass="col-span-12 shadow-xl" class="w-full object-cover" src={page.metadata.gallery[0].url} lazy={false} />
				<Figure figureClass="col-span-6 lg:col-span-3 shadow-xl" class="w-full h-full" src={page.metadata.gallery[1].url} sizes="(min-width: 640px) 25vw, 50vw" />
				<Figure figureClass="col-span-6 lg:col-span-3 shadow-xl" class="w-full h-full" src={page.metadata.gallery[2].url} sizes="(min-width: 640px) 25vw, 50vw" />
				<Figure figureClass="col-span-6 lg:col-span-3 shadow-xl" class="w-full h-full" src={page.metadata.gallery[3].url} sizes="(min-width: 640px) 25vw, 50vw" />
				<Figure figureClass="col-span-6 lg:col-span-3 shadow-xl" class="w-full h-full" src={page.metadata.gallery[4].url} sizes="(min-width: 640px) 25vw, 50vw" />
				<Figure figureClass="col-span-12 sm:col-span-4 shadow-xl" class="w-full object-cover" src={page.metadata.gallery[5].url} sizes="(min-width: 640px) 33vw, 100vw" />
				<Figure figureClass="col-span-12 sm:col-span-4 shadow-xl" class="w-full object-cover" src={page.metadata.gallery[6].url} sizes="(min-width: 640px) 33vw, 100vw" />
				<Figure figureClass="col-span-12 sm:col-span-4 shadow-xl" class="w-full object-cover" src={page.metadata.gallery[7].url} sizes="(min-width: 640px) 33vw, 100vw" />
			</div>
		</Container> -->
	</Section>
</Layout>
