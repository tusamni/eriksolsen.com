---
// props
export interface Props {
    src: string;
    metadata?: boolean;
    sizes?: string;
    figureClass?: string;
}
const { src, metadata = true, sizes = "100vw", figureClass, ...attrs } = Astro.props;

// functions
import { getPublicPath } from "@/functions/Media";

// load image data from content collection
import { getEntryBySlug } from "astro:content";
const image = await getEntryBySlug("images", src);
---

<div class:list={[figureClass, "overflow-hidden relative group"]}>
    {
        image ? (
            <img
                src={image.slug ? getPublicPath(`${image.slug}.jpg`) : getPublicPath(`images/${src}.jpg`)}
                alt={image.data.description}
                sizes={sizes}
                {...attrs}
                data-img={image.slug ? getPublicPath(`${image.slug}.jpg`) : getPublicPath(`images/${src}.jpg`)}
                data-alt={image.data.title}
                data-caption={image.data.description}
                data-width={image.data.width}
                data-height={image.data.height}
            />
        ) : (
            <img src={getPublicPath(`images/${src}.jpg`)} sizes={sizes} {...attrs} data-img={getPublicPath(`images/${src}.jpg`)} />
        )
    }

    {
        metadata && (
            <>
                <a href={`/photography/photo/${image.slug}`} title="View photo details" class="absolute bottom-0 rounded-tr-sm left-0 bg-white uppercase text-sm pl-3 pr-4 py-3 font-medium transition-all duration-200 no-underline">
                    {image.data.title}
                </a>
            </>
        )
    }
</div>
