---
// layouts
import Layout from "@/layouts/BaseLayout";

// components
import { formatDate } from "@/functions/DateTime";
import { getEntry } from "astro:content";
import Container from "@/components/content/Container";
import Figure from "@/components/image/Figure";
import Flex from "@/components/image/Flex";
import FlexItem from "@/components/image/FlexItem";
import Heading from "@/components/content/Heading";
import Picture from "@/components/image/Picture";
import Prose from "@/components/content/Prose";
import Section from "@/components/content/Section";

// content
const { slug } = Astro.params;
const shoot = await getEntry("shoots", slug);

// if no image found, return 404
if (!shoot) return Astro.redirect("/404");
// export async function getStaticPaths() {
//     const shoots = await getCollection("shoots");
//     return shoots.map((entry) => ({
//         params: { slug: shoot.slug },
//         props: { entry },
//     }));
// }

const { Content } = await shoot.render();
---

<Layout title={shoot.data.title} description={shoot.data.description} footerPadding={true}>
    <Section>
        <Container innerClass="relative">
            <Heading>
                <h1 slot="heading">{shoot.data.title}</h1>
            </Heading>
        </Container>

        <Figure src={shoot.data.images.hero} class="h-full w-full object-cover" loading="eager" rounded={false} sizes="100vw" />

        <Container>
            <div class="space-y-16 relative">
                {
                    shoot.data.auction && (
                        <dl class="flex gap-8 sm:gap-0 text-gray-900 ">
                            <div class="border-neutral-200 sm:px-8 sm:py-3 sm:border-l">
                                <dt class="font-semibold">Date</dt>
                                <dd>
                                    <time datetime="2023">{formatDate(shoot.data.date)}</time>
                                </dd>
                            </div>

                            <div class="border-neutral-200 sm:px-8 sm:py-3 sm:border-l">
                                <dt class="font-semibold">Auction</dt>
                                <dd>
                                    <a href={shoot.data.auction.url} target="_blank">
                                        {shoot.data.auction.site}
                                    </a>
                                </dd>
                            </div>

                            <div class="border-neutral-200 sm:px-8 sm:py-3 sm:border-l">
                                <dt class="font-semibold">Price</dt>
                                <dd>${Intl.NumberFormat().format(shoot.data.auction.price)}</dd>
                            </div>
                        </dl>
                    )
                }
            </div>
        </Container>

        <Container>
            {shoot.body && <Content />}
        </Container>
    </Section>
</Layout>

<style>
    :global(h2) {
        @apply text-balance;
    }
</style>
