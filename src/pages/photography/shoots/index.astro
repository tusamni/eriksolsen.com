---
// layout
import Layout from "@/layouts/BaseLayout";

// components
import Container from "@/components/content/Container";
import Figure from "@/components/image/Figure";
import Heading from "@/components/content/Heading";
import Shoot from "@/components/card/Shoot";
import Split from "@/components/content/Split";

// content
import { getCollection } from "astro:content";
const featured = (
    await getCollection("shoots", ({ data }) => {
        return data.featured == true;
    })
)
    .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf())
    .slice(0, 1);

const shoots = (await getCollection("shoots")).sort(
    (a, b) => b.data.date.valueOf() - a.data.date.valueOf()
);

// make a unique list of the categories
const allCategories = [];
shoots.map((s) => allCategories.push(s.data.category));
const uniqueCategories = [...new Set(allCategories)];

// make a unique list of the brands
const allBrands = [];
shoots.map((s) => {
    if (s.data.brand) {
        allBrands.push(s.data.brand);
    }
});
const uniqueBrands = [...new Set(allBrands)];

// functions
import { formatDate } from "@/functions/DateTime";
---

<Layout>
    <Container>
        <Heading>
            <h1 slot="heading">Automotive<br />Photoshoots</h1>
            <p slot="description">These are my recent shoots</p>
        </Heading>
    </Container>

    <Container>
        <Split small={true} float={true}>
            <div slot="heading" class="space-y-8">
                <h3>Shoot Filters</h3>
                <div class="space-y-2">
                    <p class="font-semibold text-xl">Categories</p>
                    {
                        uniqueCategories.map((c) => (
                            <div class="text-lg">{c}</div>
                        ))
                    }
                </div>
                <div class="space-y-2">
                    <p class="font-semibold text-xl">Manufacturer</p>
                    {uniqueBrands.map((b) => <div class="text-lg">{b}</div>)}
                </div>
                <div class="italic text-neutral-700">
                    Viewing {shoots.length} Shoots
                </div>
            </div>

            <a
                slot="bottom"
                href="/blog"
                class="button button-ghost w-fit text-lg">
                View all posts
            </a>

            <div class="space-y-12">
                {
                    shoots.map((s, i) => (
                        <div class="group relative flex items-center justify-center h-[35em]">
                            <Figure
                                src={s.data.hero}
                                figureClass="absolute w-full h-full"
                                class="w-full h-full object-cover"
                                metadata={false}
                                loading="eager"
                                sizes="100vw"
                            />

                            <a
                                href={`/photography/shoots/${s.slug}`}
                                class="bg-white absolute bottom-0 left-0 z-10 space-y-3 md:px-4 md:py-6 w-3/4">
                                <div class="flex justify-between items-center hover:cursor-pointer">
                                    <h4>{s.data.title}</h4>
                                </div>

                                <p class="text-neutral-800 dark:text-neutral-400 text-lg md:text-xl leading-8 transition-all duration-300 line-clamp-2">
                                    {s.data.description}
                                </p>

                                <div class="flex gap-4 items-center text-sm">
                                    <time>{formatDate(s.data.date)}</time>
                                    <span>//</span>
                                    <div>{s.data.gallery.length} photos</div>
                                </div>
                            </a>
                        </div>
                    ))
                }
            </div>
        </Split>
    </Container>
</Layout>
